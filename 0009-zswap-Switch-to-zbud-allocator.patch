From 647e64650dddf72a3eb2a10d77fe2a086adbe5c8 Mon Sep 17 00:00:00 2001
From: Quyen <quyenach1234@gmail.com>
Date: Mon, 15 Aug 2016 23:59:22 +0700
Subject: [PATCH 9/9] zswap: Switch to zbud allocator

---
 arch/arm/configs/grandprimeve3g-dt_defconfig | 1 +
 mm/zswap.c                                   | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/arm/configs/grandprimeve3g-dt_defconfig b/arch/arm/configs/grandprimeve3g-dt_defconfig
index 6ca9b0a630d..93dfb620b4a 100644
--- a/arch/arm/configs/grandprimeve3g-dt_defconfig
+++ b/arch/arm/configs/grandprimeve3g-dt_defconfig
@@ -3450,6 +3450,7 @@ CONFIG_FRONTSWAP=y
 CONFIG_ZSMALLOC=y
 CONFIG_PGTABLE_MAPPING=y
 CONFIG_ZSWAP=y
+CONFIG_ZBUD=y
 CONFIG_ZRAM=y
 CONFIG_ZRAM_LZ4_COMPRESS=y
 CONFIG_ZPOOL=y
diff --git a/mm/zswap.c b/mm/zswap.c
index e03f3d67a94..123a2981051 100644
--- a/mm/zswap.c
+++ b/mm/zswap.c
@@ -90,12 +90,12 @@ static char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;
 module_param_named(compressor, zswap_compressor, charp, 0444);
 
 /* The maximum percentage of memory that the compressed pool can occupy */
-static unsigned int zswap_max_pool_percent = 20;
+static unsigned int zswap_max_pool_percent = 95;
 module_param_named(max_pool_percent,
 			zswap_max_pool_percent, uint, 0644);
 
 /* Compressed storage to use */
-#define ZSWAP_ZPOOL_DEFAULT "zsmalloc"
+#define ZSWAP_ZPOOL_DEFAULT "zbud"
 static char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;
 module_param_named(zpool, zswap_zpool_type, charp, 0444);
 
-- 
2.18.0

